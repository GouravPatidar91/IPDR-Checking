<?xml version="1.0" encoding="UTF-8"?>
<svg width="900" height="600" viewBox="0 0 900 600" fill="none" xmlns="http://www.w3.org/2000/svg">
  <rect width="900" height="600" fill="#f8f9fa"/>
  <!-- User -->
  <rect x="60" y="40" width="160" height="60" rx="12" fill="#4F8EF7"/>
  <text x="140" y="75" text-anchor="middle" font-size="18" fill="#fff" font-family="Arial">User (Streamlit)</text>
  <!-- Arrow to Frontend -->
  <line x1="140" y1="100" x2="140" y2="160" stroke="#333" stroke-width="2" marker-end="url(#arrow)"/>
  <!-- Streamlit Frontend -->
  <rect x="40" y="160" width="200" height="110" rx="16" fill="#6EC6FF"/>
  <text x="140" y="185" text-anchor="middle" font-size="16" fill="#fff" font-family="Arial">Streamlit Frontend</text>
  <text x="140" y="205" text-anchor="middle" font-size="13" fill="#fff" font-family="Arial">- File Upload</text>
  <text x="140" y="220" text-anchor="middle" font-size="13" fill="#fff" font-family="Arial">- Real-time Ingestion</text>
  <text x="140" y="235" text-anchor="middle" font-size="13" fill="#fff" font-family="Arial">- Visualization (PyVis, Map)</text>
  <text x="140" y="250" text-anchor="middle" font-size="13" fill="#fff" font-family="Arial">- Anomaly Table</text>
  <!-- Arrow to Backend -->
  <line x1="140" y1="270" x2="350" y2="270" stroke="#333" stroke-width="2" marker-end="url(#arrow)"/>
  <!-- FastAPI Backend -->
  <rect x="350" y="210" width="200" height="120" rx="16" fill="#00B894"/>
  <text x="450" y="235" text-anchor="middle" font-size="16" fill="#fff" font-family="Arial">FastAPI Backend</text>
  <text x="450" y="255" text-anchor="middle" font-size="13" fill="#fff" font-family="Arial">- Modular Routers</text>
  <text x="450" y="270" text-anchor="middle" font-size="13" fill="#fff" font-family="Arial">/upload/ /analyze/ /stream/</text>
  <text x="450" y="285" text-anchor="middle" font-size="13" fill="#fff" font-family="Arial">/connections/ /enrich/</text>
  <!-- Arrow to Core Processing -->
  <line x1="450" y1="330" x2="450" y2="370" stroke="#333" stroke-width="2" marker-end="url(#arrow)"/>
  <!-- Core Processing -->
  <rect x="350" y="370" width="200" height="110" rx="16" fill="#FFD86E"/>
  <text x="450" y="395" text-anchor="middle" font-size="16" fill="#333" font-family="Arial">Core Processing</text>
  <text x="450" y="415" text-anchor="middle" font-size="13" fill="#333" font-family="Arial">- Parsing (CSV/JSON)</text>
  <text x="450" y="430" text-anchor="middle" font-size="13" fill="#333" font-family="Arial">- Graph Construction</text>
  <text x="450" y="445" text-anchor="middle" font-size="13" fill="#333" font-family="Arial">- Anomaly Detection</text>
  <text x="450" y="460" text-anchor="middle" font-size="13" fill="#333" font-family="Arial">- Data Enrichment</text>
  <!-- Arrows to DB/APIs -->
  <line x1="550" y1="425" x2="700" y2="425" stroke="#333" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="450" y1="480" x2="450" y2="540" stroke="#333" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="350" y1="425" x2="200" y2="425" stroke="#333" stroke-width="2" marker-end="url(#arrow)"/>
  <!-- SQLite DB -->
  <rect x="700" y="390" width="140" height="70" rx="12" fill="#A29BFE"/>
  <text x="770" y="420" text-anchor="middle" font-size="14" fill="#fff" font-family="Arial">SQLite DB</text>
  <text x="770" y="435" text-anchor="middle" font-size="12" fill="#fff" font-family="Arial">(Storage)</text>
  <!-- GeoIP API -->
  <rect x="390" y="540" width="120" height="40" rx="10" fill="#FF7675"/>
  <text x="450" y="565" text-anchor="middle" font-size="13" fill="#fff" font-family="Arial">GeoIP API</text>
  <text x="450" y="580" text-anchor="middle" font-size="11" fill="#fff" font-family="Arial">(ip-api.com)</text>
  <!-- AbuseIPDB -->
  <rect x="60" y="390" width="120" height="70" rx="12" fill="#636e72"/>
  <text x="120" y="420" text-anchor="middle" font-size="14" fill="#fff" font-family="Arial">AbuseIPDB</text>
  <text x="120" y="435" text-anchor="middle" font-size="12" fill="#fff" font-family="Arial">(Threat Intel)</text>
  <!-- Arrowhead marker -->
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="10" refY="5" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L10,5 L0,10 L2,5 Z" fill="#333" />
    </marker>
  </defs>
</svg>
